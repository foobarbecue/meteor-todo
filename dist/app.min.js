angular.module("ttl",[]).run(["$rootScope",function(e){e.safeApply=function(e){var n=this.$root.$$phase;"$apply"==n||"$digest"==n?e&&"function"==typeof e&&e():this.$apply(e)}}]).run(["$rootScope",function(e){Ceres=new Asteroid("meteor.mondora.com"),Tasks=Ceres.getCollection("tasks"),Users=Ceres.getCollection("users"),Ceres.subscribe("tasks"),Ceres.on("login",function(){e.safeApply(function(){e.user=Users.reactiveQuery({}).result[0],e.loggedIn=!0})}),Ceres.on("logout",function(){e.safeApply(function(){delete e.user,e.loggedIn=!1})})}]).controller("MainController",["$scope",function(e){var n=Tasks.reactiveQuery({});n.on("change",function(){e.safeApply(function(){e.tasks=n.result})}),e.tasks=n.result,e.login=function(){Ceres.loginWithGithub()},e.input={},e.add=function(){var n={name:e.user.profile.name,userId:e.user._id,description:e.input.description,status:"todo"};Tasks.insert(n),e.input.description=""},e.delete=function(n){var s=e.tasks[n]._id;Tasks.remove(s)},e.done=function(n){var s=e.tasks[n]._id;Ceres.call("markAsDone",s)},e.ownsTask=function(n){return e.user&&e.user._id===n},e.isDone=function(e){return"done"===e}}]);