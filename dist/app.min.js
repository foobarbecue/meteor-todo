angular.module("ttl",[]).run(["$rootScope",function(e){e.safeApply=function(e){var o=this.$root.$$phase;"$apply"==o||"$digest"==o?e&&"function"==typeof e&&e():this.$apply(e)}}]).run(["$rootScope",function(e){var o={host:"http://mondora.meteor.com",do_not_autocreate_collections:!0};o.ddpOptions={endpoint:"ws://mondora.meteor.com/websocket",SocketConstructor:WebSocket},Ceres=new Asteroid(o),Tasks=Ceres.createCollection("tasks"),Users=Ceres.createCollection("users"),Ceres.subscribe("tasks"),Ceres.on("login",function(){e.safeApply(function(){e.user=Users.findOne({}),e.loggedIn=!0})}),Ceres.on("logout",function(){e.safeApply(function(){delete e.user,e.loggedIn=!1})})}]).controller("MainController",["$scope",function(e){e.tasks=Tasks.find({});var o=function(){e.safeApply(function(){e.tasks=Tasks.find({})})};Tasks.on("insert",o),Tasks.on("update",o),Tasks.on("remove",o),e.login=function(){Ceres.loginWithGithub()},e.input={},e.add=function(){var o={name:e.user.profile.name,userId:e.user._id,description:e.input.description,status:"todo"};Tasks.insert(o),e.input.description=""},e.delete=function(o){var n=e.tasks[o]._id;Tasks.remove(n)},e.done=function(o){var n=e.tasks[o]._id;Ceres.call("markAsDone",n)},e.ownsTask=function(o){return e.user&&e.user._id===o},e.isDone=function(e){return"done"===e}}]);